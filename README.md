edu.html
################################################################################################################################################################################################
순차 빌드 프롬프트 세트
################################################################################################################################################################################################
0. 공통 가이드(모든 단계 프롤로그로 함께 보낼 문단)
규칙:
- 단일 HTML 파일(내장 CSS/JS). 외부 빌드 없이 브라우저 즉시 실행.
- three.js, OrbitControls, CSS2DRenderer는 ./lib 경로 <script>로 로드.
- 이전 단계 코드/기능은 보존. 관련 없는 영역은 변경 금지.
- 새로 추가/수정한 부분엔 주석을 달고, 전역 상수/함수는 상단에 정리.
- 에러 없는 상태로 완전한 HTML 전체를 출력.
##############################################################################################################################
1. 스캐폴딩 & 기본 장면
목표: 다크 테마 UI + three.js 기본 장면 스캐폴딩.
요구사항(AC):
- WebGLRenderer, CSS2DRenderer, PerspectiveCamera, OrbitControls 구성.
- 배경 #0b1220, HemisphereLight, GridHelper(크기 4000, 세분 24).
- 좌상단 글래스 UI 패널과 버튼 placeholder만 배치(기능 연결은 이후).
출력 형식: 완전한 단일 HTML.
##############################################################################################################################
2. 바닥판(노치 포함)과 기준점/센트로이드
목표: 방수판(1500×1200, T=0.1)과 400×400 노치(원점 기준 Z-방향) 생성.
요구사항(AC):
- ExtrudeGeometry로 plate + Path로 노치 타공.
- 주요 점 V.A~V.G 정의, polygonCentroid 함수로 CENTROID 계산.
- 카메라 타겟을 CENTROID로 세팅.
출력 형식: 단일 HTML(1단계에 덮어쓰기), 오류 없음.
##############################################################################################################################
3. 벽체/면목/기둥 배치 유틸
목표: addVerticalBoard, addTriPrismOnEdge, addAxisAlignedPillar 유틸과 배치.
요구사항(AC):
- WALL_H=300, WALL_T=70, TRI(40,40), PILLAR_H=300 상수화.
- 외곽/노치 경계에 벽 4개, 코너 삼각면목 4개, 기둥 2개 배치.
- 바닥/법선 기준으로 두께 오프셋 계산(place='outset' 지원).
출력 형식: 단일 HTML. 주석으로 배치 좌표 근거 표기.
##############################################################################################################################
4. 치수선/높이/두께 치수 + 표시 토글
목표: 치수 라벨/가이드 유틸과 UI 토글 연결.
요구사항(AC):
- addDimSegment, addDimToward, addHeightDimAt, addThicknessDimOnEdgeOutside 구현.
- “치수: ON” 버튼으로 dimsGroup 표시 토글.
- 표기: 1500, 1200, 400, 400, 높이 300, 두께 70.
- CSS2DRenderer는 일단 항상 렌더(최적화는 후반 단계).
출력 형식: 단일 HTML.
##############################################################################################################################
5. 마킹(바닥/수직면 사각) 유틸 + 토글
목표: 마킹 사각 표시 유틸과 샘플 마킹 추가.
요구사항(AC):
- addMarkQuad3D, addMarkRect, addMarkRectVerticalX/Z 구현.
- “마킹영역: ON” 버튼으로 markGroup 토글.
- 샘플: 50mm/100mm 영역, 파이프 500×700 표시 등 4~6개.
출력 형식: 단일 HTML.
##############################################################################################################################
6. 단계(1~15) 데이터 모델 + 카메라 트윈
목표: WORK_STEPS(1~15)·STEP_INFO·카메라 flyTo 이징 구축.
요구사항(AC):
- STEP_INFO: title/img/html(이미지 없으면 data-URL 플레이스홀더).
- flyTo: easeInOut 보간, 기본 offset [600,520,900].
- UI: “자동플레이(5초 간격)” 버튼, 단계 셀렉터 + “단계 이동” 버튼.
- 각 단계 선택/재생 시 해당 위치로 카메라 이동 + 표시(바닥/수직면 자동 판정).
출력 형식: 단일 HTML.
##############################################################################################################################
7. 단계 툴팁(월드좌표 추적)
목표: 단계 선택 시 화면에 고정 툴팁 표시(월드→스크린 변환).
요구사항(AC):
- tipState.world 따라다니기, 화면 경계 margin clamp.
- 툴팁 닫기 버튼, 자동·단일 모두에서 동일 동작.
출력 형식: 단일 HTML.
##############################################################################################################################
8. 재단 모달(롤 전개 UI 뼈대)
목표: 모달 레이아웃 + rollGrid/rollSheet/cutLayer/핸들/길이 인디케이터.
요구사항(AC):
- ROLL_WIDTH_MM=1000, ROLL_LENGTH_MM=5000, STEP_MM=100, mm2px 동적 계산.
- 드래그/휠로 길이 변경, 길이 텍스트 실시간 갱신.
- 붉은 가이드 라인 레이어(ensureGuideLayer, setGuideLines, updateGuideLines) 뼈대만.
출력 형식: 단일 HTML.
##############################################################################################################################
9. 절단 패턴 + 디바운스/스냅/가이드 연동
목표: 조각 레이아웃(rebuildCuts)·디바운스·50mm 스냅·가이드 이동 완성.
요구사항(AC):
- addPiecePx, rowRightTop 등으로 ①~⑮ 라벨 구성(제시된 규격대로).
- 드래그 중 디바운스 120ms, 손 뗄 때 SNAP_MM=50으로 최종 스냅.
- setGuideLines([800,1150,2650,3450,4050]) 적용, 길이에 맞춰 상향 이동.
출력 형식: 단일 HTML.
##############################################################################################################################
10. 최적화 & 정리(좌표 버튼/라벨 제거 고정)
목표: 성능 최적화와 최종 정리.
요구사항(AC):
- “좌표” 토글/좌표 라벨 기능 **완전 제거**(버튼/그룹/생성/토글 코드 전부 삭제).
- CSS2DRenderer 조건부 렌더: (치수 ON 또는 마킹 ON)일 때만 render.
- GridHelper 세분 24, AxesHelper 120, setPointerCapture try/catch.
- 불필요한 DOM 업데이트 최소화(applyLength에서 rebuildCuts 디바운스).
- 전체 파일 출력, 콘솔 에러 0.
출력 형식: 단일 HTML(최종).
##############################################################################################################################
단계별 “짧은 템플릿” (모든 단계에 공통 적용 가능)
[목표] <한 문장으로 작업 목표>

[요구사항(AC)]
- <테스트 가능한 조건 1>
- <테스트 가능한 조건 2>
- <이전 기능 보존 / 변경 금지 구역 명시>

[출력 형식]
- 단일 HTML 전체. 주석으로 변경점 표기. 런타임 에러 없음.
##############################################################################################################################
이슈 발생 시 미세 프롬프트

“rebuildCuts에서 ⑫ 라벨이 겹칩니다. 해당 라벨의 위치 계산을 보정하고, 겹침 방지 최소 간격 4px을 적용하세요. 다른 라벨 배치는 변경하지 마세요.”

“CSS2DRenderer가 치수/마킹 OFF에도 렌더 호출됩니다. 조건부 렌더 함수로 묶고, OFF일 땐 호출하지 않도록 수정하세요. 다른 로직은 변경 금지.”


################################################################################################################################################################################################
복붙용 마스터 프롬프트 (Single-file HTML 생성)
################################################################################################################################################################################################
당신은 숙련된 프론트엔드 엔지니어입니다. 아래 요구사항을 모두 만족하는
“단일 HTML 파일”을 만들어 주세요. 외부 빌드 없이 브라우저에서 바로 실행 가능해야 합니다.

[아키텍처/라이브러리]
- three.js + OrbitControls + CSS2DRenderer 사용.
- 로딩은 <script src="./lib/three.min.js">, "./lib/controls/OrbitControls.js",
  "./lib/renderers/CSS2DRenderer.js" 경로를 사용(대체로 로컬 lib 폴더를 가정).
- 번들/프레임워크 불필요. 단일 HTML 안에 CSS/JS 포함.

[장면 스펙]
- 방수판 바닥: W=1500, D=1200(mm), 두께 T=0.1.
- 노치: X 방향 400, Z 방향 400, 노치 시작 Z=800(원점은 좌상 모서리, Z는 – 방향으로 렌더링됨).
- 벽(WALL_H=300, WALL_T=70)과 삼각면목(TRI_W=40, TRI_H=40) 및 2개 기둥(PILLAR_H=300) 배치.
- 주요 외곽/노치 라인 기준 치수 표기(1500,1200,400,400), 두께 70, 높이 300 치수 라벨.
- 어두운 테마 UI, 좌상단 글래스 패널(#0b1220 베이스).

[UI]
- 버튼: “치수: ON”, “마킹영역: ON”, “재단 보기”, “자동플레이”, 단계 선택 드롭다운 + “단계 이동”.
- (중요) “좌표” 토글은 **제거**. 좌표 라벨과 관련된 생성/토글 로직도 넣지 말 것.

[툴팁/작업순서]
- 총 15단계 WORK_STEPS. 각 단계는 중심점(c), 필요 시 plane/size, cam 옵션 포함.
- STEP_INFO로 각 단계 타이틀/이미지/설명 바인딩. 이미지 없으면 플레이스홀더 표시.
- “자동플레이”는 5초 간격, 단일 단계 이동 시에도 해당 단계로 카메라 트윈 이동.
- 카메라 이동: easeInOut, target/position 보간. off=[600,520,900] 기본.

[마킹/표시]
- 바닥/수직면 사각 마킹 유틸(addMarkQuad3D, addMarkRectVerticalX/Z).
- 샘플 마킹 영역은 코드로 그대로 추가(50mm, 100mm 예시 포함).
- 치수와 마킹 그룹만 CSS2DRenderer로 라벨을 그림.
  (성능을 위해 두 그룹이 숨김일 때는 CSS2D 렌더를 호출하지 않음)

[재단(롤 전개) 모달]
- ROLL_WIDTH_MM=1000, ROLL_LENGTH_MM=5000, STEP_MM=100.
- 드래그/휠로 길이 조절: 드래그 중에는 디바운스(120ms), 손 뗄 때 SNAP_MM=50으로 스냅.
- mm→px 스케일 mm2px 동적 계산. 좌측 100mm 시각 밴드.
- 굵은 가이드 라인(붉은선): mm 위치 [800,1150,2650,3450,4050]에 표시(시트 길이에 맞춰 위로 이동).
- 절단 조각 cutLayer에 DOM div로 배치:
  - 0~200: ①~④ 200×200, 잉여 shrink
  - 200~400: ⑤ 1000×200
  - 400~600: ⑥ 400×200, ⑦ 400×200
  - 600~800: ⑧ 800×200
  - 800~1150: 이후 ⑨ 500×150, ⑮ 500×200, ⑩ 300×300 블록 구성
  - 1150~2650: ⑪ 1000×1500
  - 2650~3450: ⑫ 1000×800
  - 3450~4050: ⑭ 450×600, ⑬ 450×500 등 (라벨 포함)
- 터치/포인터 대응: Pointer Events 기본, setPointerCapture 예외 안전 처리, 레거시 터치 폴백 제공.

[최적화/품질 기준]
- 좌표 라벨/버튼 없음. 관련 코드/그룹 미생성.
- labelRenderer.render(scene,camera)는 치수/마킹이 보일 때만 호출.
- GridHelper 세분은 24 정도(퍼포먼스), AxesHelper는 120 정도.
- 불필요한 DOM 쓰기 최소화: applyLength 재계산을 디바운스, rebuildCuts는 필요 시에만.
- 코드 전반 const/let 정리, 함수화, 매직넘버 상수화.
- 모든 텍스트/버튼은 한국어. CSS는 다크 테마 + 유리질감.

[인도물]
- index.html 하나. 즉시 실행 가능해야 함.
- 주석으로 핵심 블록에 역할 설명.
